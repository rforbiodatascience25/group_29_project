---
title: "Analysis 3"
format:
  html:
    embed-resources: true
editor: visual
---

# Loading packages

```{r}
#| label: load_packages
#| message: false
#| warning: false

library(tidyverse)
library(scales)
library(patchwork)

source(here::here("R", "99_proj_func.R"))
```

# Loading data files

```{r}
#| label: load_data
#| message: false
#| warning: false

data_aug <- read_csv(here::here("data", "data_aug.csv"))

```

# Flourescence of B cells

```{r}
#| label: B_cells_blood
#| message: false
#| warning: false
#| fig-height: 10
#| fig-width: 9

p1 <- data_aug |>
  asc_CDs_boxplot(lineage = "B cells",
                  hierarchy_level = 3,
                  tissue = "blood",
                  measure = MedQb)

p2 <- data_aug |>
  asc_CDs_boxplot(lineage = "B cells",
                  hierarchy_level = 3,
                  tissue = "blood",
                  measure = CVQb)

p1 / p2
```

```{r}
#| label: B_cells_tonsil
#| message: false
#| warning: false
#| fig-height: 10
#| fig-width: 9

p1 <- data_aug |>
  asc_CDs_boxplot(lineage = "B cells",
                  hierarchy_level = 3,
                  tissue = "tonsil",
                  measure = MedQb)

p2 <- data_aug |>
  asc_CDs_boxplot(lineage = "B cells",
                  hierarchy_level = 3,
                  tissue = "tonsil",
                  measure = CVQb)

p1 / p2
```

# Flourescence of T cells

```{r}
#| label: CD4_T_cells
#| message: false
#| warning: false
#| fig-height: 12
#| fig-width: 9

p1 <- data_aug |>
  asc_CDs_boxplot(lineage = "CD4 T cells",
                  hierarchy_level = 4,
                  tissue = "blood",
                  measure = MedQb)

p2 <- data_aug |>
  asc_CDs_boxplot(lineage = "CD4 T cells",
                  hierarchy_level = 4,
                  tissue = "blood",
                  measure = CVQb)
p1 / p2
```

```{r}
#| label: CD8_T_cells
#| message: false
#| warning: false
#| fig-height: 10
#| fig-width: 9

p1 <- data_aug |>
  asc_CDs_boxplot(lineage = "CD8 T cells",
                  hierarchy_level = 4,
                  tissue  = "blood",
                  measure = MedQb)

p2 <- data_aug |>
  asc_CDs_boxplot(lineage = "CD8 T cells",
                  hierarchy_level = 4,
                  tissue = "blood",
                  measure = CVQb)

p1 / p2
```

```{r}
#| label: Thymocytes
#| message: false
#| warning: false
#| fig-height: 10
#| fig-width: 9

p1 <- data_aug |>
  asc_CDs_boxplot(lineage = "thymocytes",
                  hierarchy_level = 4,
                  tissue = "thymus",
                  measure = MedQb)

p2 <- data_aug |>
  asc_CDs_boxplot(lineage = "thymocytes",
                  hierarchy_level = 4,
                  tissue = "thymus",
                  measure = CVQb)

p1 / p2
```

To look at the variation in ASC-related CD markers, a boxplot was generated for four selected immune cell types in their different relevant tissues. For each cell type, both MedQb and CVQb were visualized side by side to provide an overall overview of signal strength and internal variation.

The following combinations are used in the analysis view:

-   B cells from blood at hierarchy level 3

-   B cells from tonsil at hierarchy level 3

-   CD4 T cells from blood at hierarchy level 4

-   CD8 T cells from blood at hierarchy level 4

-   Thymocytes from thymus at hierarchy level 4
